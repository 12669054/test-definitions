metadata:
  name: mauve
  format: "Lava-Test-Shell Test Definition 1.0"
  description: "Java Mauve Tests for Open Embedded"
  version: 1.0

install:
  git-repos:
    - git://git.linaro.org/qa/test-definitions.git
    - git://git.linaro.org/people/andrew.mcdermott/mauve.git

run:
  steps:
    - 'DISPLAY=:10'
    - 'export DISPLAY'
    - 'Xvfb $DISPLAY &'
    - 'XVFBPID=$!'
    - 'PATH=$PATH:/lava/tests/$TESTRUN_ID/test-definitions/openembedded/scripts'
    - 'rm -rf /tmp/mauve'
    - 'ln -s /lava/tests/$TESTRUN_ID/mauve /tmp/mauve'
    - 'cd /tmp/mauve'
    - 'lava-test-case java.lang --shell mauve-test-pkg gnu.testlet.java.lang -showpasses'
    - 'lava-test-case gnu.java --shell mauve-test-pkg gnu.testlet.gnu.java -showpasses'
    - 'lava-test-case gnu.javax --shell mauve-test-pkg gnu.testlet.gnu.javax -showpasses'
    - 'lava-test-case java.awt --shell mauve-test-pkg gnu.testlet.java.awt -showpasses'
    - 'lava-test-case java.beans --shell mauve-test-pkg gnu.testlet.java.beans -showpasses'
    - 'lava-test-case java.io --shell mauve-test-pkg gnu.testlet.java.io -showpasses'
    - 'lava-test-case java.math --shell mauve-test-pkg gnu.testlet.java.math -showpasses'
    - 'lava-test-case java.net --shell mauve-test-pkg gnu.testlet.java.net -showpasses'
    - 'lava-test-case java.nio --shell mauve-test-pkg gnu.testlet.java.nio -showpasses'
    - 'lava-test-case java.rmi --shell mauve-test-pkg gnu.testlet.java.rmi -showpasses'
    - 'lava-test-case java.security --shell mauve-test-pkg gnu.testlet.java.security -showpasses'
    - 'lava-test-case java.sql --shell mauve-test-pkg gnu.testlet.java.sql -showpasses'
    - 'lava-test-case java.text --shell mauve-test-pkg gnu.testlet.java.text -showpasses'
    - 'lava-test-case java.util --shell mauve-test-pkg gnu.testlet.java.util -showpasses'
    - 'lava-test-case javax.accessibility --shell mauve-test-pkg gnu.testlet.javax.accessibility -showpasses'
    - 'lava-test-case javax.crypto --shell mauve-test-pkg gnu.testlet.javax.crypto -showpasses'
    - 'lava-test-case javax.imageio --shell mauve-test-pkg gnu.testlet.javax.imageio -showpasses'
    - 'lava-test-case javax.management --shell mauve-test-pkg gnu.testlet.javax.management -showpasses'
    - 'lava-test-case javax.naming --shell mauve-test-pkg gnu.testlet.javax.naming -showpasses'
    - 'lava-test-case javax.net --shell mauve-test-pkg gnu.testlet.javax.net -showpasses'
    - 'lava-test-case javax.print --shell mauve-test-pkg gnu.testlet.javax.print -showpasses'
    - 'lava-test-case javax.rmi --shell mauve-test-pkg gnu.testlet.javax.rmi -showpasses'
    - 'lava-test-case javax.security --shell mauve-test-pkg gnu.testlet.javax.security -showpasses'
    - 'lava-test-case javax.sound --shell mauve-test-pkg gnu.testlet.javax.sound -showpasses'
    - 'lava-test-case javax.swing --shell mauve-test-pkg gnu.testlet.javax.swing -showpasses'
    - 'lava-test-case javax.xml --shell mauve-test-pkg gnu.testlet.javax.xml -showpasses'
    - 'lava-test-case locales --shell mauve-test-pkg gnu.testlet.locales -showpasses'
    - 'lava-test-case org.omg --shell mauve-test-pkg gnu.testlet.org.omg -showpasses'
    - 'lava-test-case org.w3c --shell mauve-test-pkg gnu.testlet.org.w3c -showpasses'
    - 'kill $XVFBPID'

# The following "parser" will correctly parse the output from the
# tests but it is deliberately commented out because you end up with
# one line per test case in the Lava dashboard and, given the number
# of tests that are run, there will be ~250 pages to wade through.

# parse:
#   pattern: "(?P<result>(PASS|FAIL|SKIP)):\\s+(?P<test_case_id>(.*))"
#   fixupdict:
#     PASS: pass
#     FAIL: fail
#     SKIP: skip
